---
sidebar_position: 3
---

import { Important, Warning } from '@site/src/components/Admonition';
import {
  ConfigSection,
  EnhancedImportant,
  EnhancedWarning,
  FieldNavigator,
  styles
} from '@site/src/components/documentation';
import failedImportPatterns from '../../../static/img/failed-import-patterns.png';

# Queue Cleaner

The Queue Cleaner monitors your *arr's queues and automatically removes downloads based on configurable criteria. This helps keep your queue clean and prevents problematic downloads from being stuck.

<FieldNavigator />

<div className={styles.documentationPage}>

<div className={styles.section}>

<ConfigSection
  id="enable-queue-cleaner"
  title="Enable Queue Cleaner"
  icon="üîÑ"
>

When enabled, the Queue Cleaner will run according to the configured schedule to automatically clean downloads from your download client queue.

</ConfigSection>

<ConfigSection
  id="scheduling-mode"
  title="Scheduling Mode"
  icon="üìÖ"
>

Choose how to configure the Queue Cleaner schedule:
- **Basic**: Simple interval-based scheduling (every X minutes/hours/seconds)
- **Advanced**: Full cron expression control for complex schedules

</ConfigSection>

<ConfigSection
  id="cron-expression"
  title="Cron Expression"
  icon="‚è≤Ô∏è"
>

Enter a valid Quartz cron expression to control when the Queue Cleaner runs.

**Common Cron Examples:**
- `0 0/5 * ? * * *` - Every 5 minutes
- `0 0 * ? * * *` - Every hour
- `0 0 */6 ? * * *` - Every 6 hours

</ConfigSection>

</div>

<div className={styles.section}>

<ConfigSection
  id="ignored-downloads"
  title="Ignored Downloads"
  icon="üö´"
>

Downloads matching these patterns will be ignored by Queue Cleaner. Patterns can match any of these:
- torrent hash
- qBittorrent tag or category
- Deluge label
- Transmission category (last directory from the save location)
- ¬µTorrent label
- torrent tracker domain

**Examples:**
```
fa800a7d7c443a2c3561d1f8f393c089036dade1
tv-sonarr
qbit-tag
mytracker.com
```

</ConfigSection>

</div>

<div className={styles.section}>

<h2 className={styles.sectionTitle}>
  <span className={styles.sectionIcon}>‚ùå</span>
  Failed Import Settings
</h2>

<ConfigSection
  id="failed-import-max-strikes"
  title="Failed Import Max Strikes"
  icon="‚ö°"
>

Number of strikes before a failed import download is removed from the queue. Set to 0 to disable failed import cleaning, minimum 3 to enable.

</ConfigSection>

<ConfigSection
  id="failed-import-ignore-private"
  title="Failed Import Ignore Private"
  icon="üîí"
>

When enabled, private torrents will be skipped during failed import cleaning. This is useful if you want to preserve private tracker content even when imports fail.

<EnhancedImportant>
This setting needs a download client to be configured.
</EnhancedImportant>

</ConfigSection>

<ConfigSection
  id="failed-import-delete-private"
  title="Failed Import Delete Private"
  icon="üóëÔ∏è"
>

When enabled, private torrents that reach the maximum strikes will be deleted from the download client. Use with caution as this will permanently remove the download.

<EnhancedWarning>
Setting this to true means private torrents will be permanently deleted, potentially affecting your private tracker account by receiving H&R if the seeding requirements are not met.
</EnhancedWarning>

<EnhancedImportant>
This setting needs a download client to be configured.
</EnhancedImportant>

</ConfigSection>

<ConfigSection
  id="failed-import-pattern-mode"
  title="Failed Import Pattern Mode"
  icon="üé≠"
>

Choose how to handle failed imports based on their patterns:
- **Exclude**: Remove all failed imports except those containing specified patterns.
- **Include**: Remove only failed imports containing specified patterns.

</ConfigSection>

<ConfigSection
  id="failed-import-patterns"
  title="Failed Import Patterns"
  icon="üìù"
>

**Examples:**
- `title mismatch`
- `manual import required`
- `recently aired`

When pattern mode is set to `Exclude`, failed imports containing these patterns will be skipped. Everything else will be removed.
When pattern mode is set to `Include`, only failed imports containing these patterns will be removed. Everything else will be skipped.

These patterns can be any substring of the failed import messages. These messsages can be viewed in the queue of your *arr application.

<img src={failedImportPatterns} alt="Failed Import Messages Example" style={{ borderRadius: '8px' }} />

</ConfigSection>

</div>

<div className={styles.section}>

<h2 className={styles.sectionTitle}>
  <span className={styles.sectionIcon}>‚è∏Ô∏è</span>
  Stalled Download Rules
</h2>

<p className={styles.sectionDescription}>
  Stalled downloads are those that have stopped downloading and show no progress. You can create multiple rules to handle different scenarios based on completion percentage and torrent privacy.
</p>

<EnhancedImportant>
These settings need a download client to be configured.
</EnhancedImportant>

<ConfigSection
  id="stall-rule-name"
  title="Rule Name"
  icon="üìù"
>

A descriptive name for this stall rule. This helps you identify the purpose of each rule when managing multiple rules.

</ConfigSection>

<ConfigSection
  id="stall-rule-enabled"
  title="Enabled"
  icon="‚úÖ"
>

Toggle to enable or disable this rule. Disabled rules won't be applied during queue cleaning.

</ConfigSection>

<ConfigSection
  id="stall-rule-max-strikes"
  title="Max Strikes"
  icon="‚ö°"
>

Number of consecutive times a download must be stalled before action is taken. Minimum value is 3.

</ConfigSection>

<ConfigSection
  id="stall-rule-privacy-type"
  title="Privacy Type"
  icon="üîí"
>

Determines which torrents this rule applies to:
- **Public Torrents Only**: Rule only applies to public torrents
- **Private Torrents Only**: Rule only applies to private torrents
- **Public and Private Torrents**: Rule applies to all torrents

</ConfigSection>

<ConfigSection
  id="stall-rule-completion-range"
  title="Completion Percentage Range"
  icon="üìä"
>

Define the completion percentage range where this rule applies:
- **Min Completion Percentage**: Rule applies once completion exceeds this value. A value of 0 includes torrents at exactly 0% and above.
- **Max Completion Percentage**: Rule applies up to and including this completion percentage.

This allows you to create different rules for different stages of a download. For example, you might be more aggressive with stalled downloads that are only 10% complete versus those that are 90% complete.

</ConfigSection>

<ConfigSection
  id="stall-rule-reset-strikes"
  title="Reset Strikes on Progress"
  icon="üîÑ"
>

When enabled, the strike count resets to zero if the download shows progress again. This prevents removal of downloads that temporarily stall but resume downloading.

</ConfigSection>

<ConfigSection
  id="stall-rule-minimum-progress"
  title="Minimum Progress to Reset"
  icon="üìè"
>

Only reset strikes after the torrent downloads at least this amount of data. Leave blank to reset on any progress. This prevents strikes from being reset by minimal progress that doesn't actually indicate the download is healthy.

</ConfigSection>

<ConfigSection
  id="stall-rule-delete-private"
  title="Delete Private from Client"
  icon="üóëÔ∏è"
>

When enabled, private torrents that reach the maximum strikes will be deleted from the download client. When disabled, they'll only be removed from the *arr queue but remain in your download client.

<EnhancedWarning>
Enabling this means private torrents will be permanently deleted from your download client, potentially affecting your private tracker account if seeding requirements aren't met.
</EnhancedWarning>

</ConfigSection>

<ConfigSection
  id="downloading-metadata-max-strikes"
  title="Downloading Metadata Max Strikes"
  icon="üìä"
>

Number of strikes before a download stuck in "Downloading Metadata" state is removed (qBittorrent only). This is separate from the rule system and applies globally.

</ConfigSection>

</div>

<div className={styles.section}>

<h2 className={styles.sectionTitle}>
  <span className={styles.sectionIcon}>üêå</span>
  Slow Download Rules
</h2>

<p className={styles.sectionDescription}>
  Slow downloads are those downloading below a specified speed threshold. You can create multiple rules to handle different scenarios based on speed, time limits, file size, completion percentage, and torrent privacy.
</p>

<EnhancedImportant>
These settings need a download client to be configured.
</EnhancedImportant>

<ConfigSection
  id="slow-rule-name"
  title="Rule Name"
  icon="üìù"
>

A descriptive name for this slow rule. This helps you identify the purpose of each rule when managing multiple rules.

</ConfigSection>

<ConfigSection
  id="slow-rule-enabled"
  title="Enabled"
  icon="‚úÖ"
>

Toggle to enable or disable this rule. Disabled rules won't be applied during queue cleaning.

</ConfigSection>

<ConfigSection
  id="slow-rule-max-strikes"
  title="Max Strikes"
  icon="‚ö°"
>

Number of consecutive times a download must be slow before action is taken. Minimum value is 3.

</ConfigSection>

<ConfigSection
  id="slow-rule-min-speed"
  title="Min Speed"
  icon="üöÄ"
>

Minimum download speed threshold (e.g., 100KB/s). Downloads consistently below this speed will accumulate strikes. Either minimum speed or maximum time must be specified.

</ConfigSection>

<ConfigSection
  id="slow-rule-max-time"
  title="Maximum Time (Hours)"
  icon="‚è∞"
>

Maximum time allowed for downloads in hours. Set to 0 to disable time-based checking. When enabled, downloads that exceed this time limit will accumulate strikes regardless of speed. Either minimum speed or maximum time must be specified.

</ConfigSection>

<ConfigSection
  id="slow-rule-privacy-type"
  title="Privacy Type"
  icon="üîí"
>

Determines which torrents this rule applies to:
- **Public Torrents Only**: Rule only applies to public torrents
- **Private Torrents Only**: Rule only applies to private torrents
- **Public and Private Torrents**: Rule applies to all torrents

</ConfigSection>

<ConfigSection
  id="slow-rule-completion-range"
  title="Completion Percentage Range"
  icon="üìä"
>

Define the completion percentage range where this rule applies:
- **Min Completion %**: Rule applies once completion exceeds this value. A value of 0 includes torrents at exactly 0% and above.
- **Max Completion %**: Rule applies up to and including this completion percentage.

This allows you to create different rules for different stages of a download. For example, you might tolerate slower speeds early in a download but expect faster speeds once it's mostly complete.

</ConfigSection>

<ConfigSection
  id="slow-rule-ignore-above-size"
  title="Ignore Above Size"
  icon="üì¶"
>

Downloads larger than this size will be ignored by this rule (e.g., 25 GB). Large files often download slower and may need more time to complete, so you might want to exclude them from aggressive slow download rules.

</ConfigSection>

<ConfigSection
  id="slow-rule-reset-strikes"
  title="Reset Strikes on Progress"
  icon="üîÑ"
>

When enabled, the strike count resets to zero if the download speed improves above the minimum threshold. This prevents removal of downloads that temporarily slow down but recover.

</ConfigSection>

<ConfigSection
  id="slow-rule-delete-private"
  title="Delete Private from Client"
  icon="üóëÔ∏è"
>

When enabled, private torrents that reach the maximum strikes will be deleted from the download client. When disabled, they'll only be removed from the *arr queue but remain in your download client.

<EnhancedWarning>
Enabling this means private torrents will be permanently deleted from your download client, potentially affecting your private tracker account if seeding requirements aren't met.
</EnhancedWarning>

</ConfigSection>

</div>

</div>